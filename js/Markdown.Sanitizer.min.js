(function(){var a,d;if(typeof exports==="object"&&typeof require==="function"){a=exports;d=require("./Markdown.Converter").Converter}else{a=window.Markdown;d=a.Converter}a.getSanitizingConverter=function(){var i=new d();i.hooks.chain("postConversion",c);i.hooks.chain("postConversion",b);return i};function c(i){return i.replace(/<[^>]*>?/gi,e)}var f=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i;var g=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i;var h=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i;function e(i){if(i.match(f)||i.match(g)||i.match(h)){return i}else{return""}}function b(m){if(m==""){return""}var s=/<\/?\w+[^>]*(\s|$|>)/g;var t=m.toLowerCase().match(s);var r=(t||[]).length;if(r==0){return m}var q,u;var p="<p><img><br><li><hr>";var n;var o=[];var j=[];var l=false;for(var i=0;i<r;i++){q=t[i].replace(/<\/?(\w+).*/,"$1");if(o[i]||p.search("<"+q+">")>-1){continue}u=t[i];n=-1;if(!/^<\//.test(u)){for(var k=i+1;k<r;k++){if(!o[k]&&t[k]=="</"+q+">"){n=k;break}}}if(n==-1){l=j[i]=true}else{o[n]=true}}if(!l){return m}var i=0;m=m.replace(s,function(v){var w=j[i]?"":v;i++;return w});return m}})();
